<div class="contenedor-lista">
  <h2>Abonos</h2>

  <div class="acciones">
    <button mat-raised-button color="primary" (click)="abrirAltaAbono()">
      + Alta Abono
    </button>
  </div>


  <mat-card>
    <div class="overflow-auto">
      <table mat-table [dataSource]="abonos" class="mat-elevation-z1 w-full" *ngIf="abonos.length">

        <!-- Cliente -->
        <ng-container matColumnDef="clienteNombre">
          <th mat-header-cell *matHeaderCellDef> Cliente </th>
          <td mat-cell *matCellDef="let abono"> {{ abono.clienteNombre }} </td>
        </ng-container>

        <!-- Tipo -->
        <ng-container matColumnDef="tipo">
          <th mat-header-cell *matHeaderCellDef> Tipo </th>
          <td mat-cell *matCellDef="let abono"> {{ abono.tipo }} </td>
        </ng-container>

        <!-- Cantidad Bidones -->
        <ng-container matColumnDef="cantidadBidones">
          <th mat-header-cell *matHeaderCellDef> Bidones/semana </th>
          <td mat-cell *matCellDef="let abono"> {{ abono.cantidadBidones }} </td>
        </ng-container>

        <!-- Precio Negociado -->
        <ng-container matColumnDef="precioNegociado">
          <th mat-header-cell *matHeaderCellDef> Precio mensual </th>
          <td mat-cell *matCellDef="let abono"> ${{ abono.precioNegociado | number: '1.2-2' }} </td>
        </ng-container>

        <!-- Fecha Inicio -->
        <ng-container matColumnDef="fechaInicio">
          <th mat-header-cell *matHeaderCellDef> Inicio </th>
          <td mat-cell *matCellDef="let abono">
            {{ abono.fechaInicio?.toDate?.() || abono.fechaInicio | date: 'dd/MM/yyyy' }}
          </td>
        </ng-container>

        <!-- Fecha FijaciÃ³n Precio -->
        <ng-container matColumnDef="fechaFijacionPrecioHasta">
          <th mat-header-cell *matHeaderCellDef> Congelado hasta </th>
          <td mat-cell *matCellDef="let abono">
            {{ abono.fechaFijacionPrecioHasta?.toDate?.() || abono.fechaFijacionPrecioHasta | date: 'dd/MM/yyyy' }}
          </td>
        </ng-container>

        <!-- Estado -->
        <ng-container matColumnDef="activo">
          <th mat-header-cell *matHeaderCellDef> Estado </th>
          <td mat-cell *matCellDef="let abono">
            <mat-chip [color]="abono.activo ? 'primary' : 'warn'" selected>
              {{ abono.activo ? 'Activo' : 'Inactivo' }}
            </mat-chip>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnas"></tr>
        <tr mat-row *matRowDef="let row; columns: columnas;"></tr>
      </table>

      <div *ngIf="!abonos.length" class="text-center mt-4">
        <p>No hay abonos registrados.</p>
      </div>
    </div>
  </mat-card>


</div>